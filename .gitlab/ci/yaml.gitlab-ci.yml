# Yamllint of CI-related yaml and changelogs.
# This uses rules from project root `.yamllint`.
lint-yaml:
  extends:
    - .default-retry
    - .yaml-lint:rules
  image: pipelinecomponents/yamllint:latest
  stage: test
  needs: []
  variables:
    # lib/gitlab/ci/templates is temporairly disabled, see https://gitlab.com/gitlab-org/gitlab/-/issues/326411.
    LINT_PATHS: .gitlab-ci.yml .gitlab/ci changelogs
  script:
    - '[[ ! -d "ee/" ]] || export LINT_PATHS="$LINT_PATHS ee/changelogs"'
    - yamllint -f colored $LINT_PATHS
