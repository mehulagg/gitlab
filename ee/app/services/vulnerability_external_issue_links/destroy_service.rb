# frozen_string_literal: true

module VulnerabilityExternalIssueLinks
  class DestroyService < BaseService
    def initialize(user, vulnerability_external_issue_link)
      @user = user
      @vulnerability_external_issue_link = vulnerability_external_issue_link
    end

    def execute
      raise Gitlab::Access::AccessDeniedError unless can?(user, :admin_vulnerability_external_issue_link, vulnerability_external_issue_link)

      vulnerability_external_issue_link.destroy
    end

    private

    attr_reader :user, :vulnerability_external_issue_link
  end
end
