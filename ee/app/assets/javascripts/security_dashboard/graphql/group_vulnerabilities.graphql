#import "~/graphql_shared/fragments/pageInfo.fragment.graphql"
#import "./vulnerability.fragment.graphql"
#import "./project.fragment.graphql"

query group(
  $fullPath: ID!
  $after: String
  $first: Int
  $projectId: [ID!]
  $severity: [VulnerabilitySeverity!]
  $reportType: [VulnerabilityReportType!]
  $scanner: [String!]
  $state: [VulnerabilityState!]
) {
  group(fullPath: $fullPath) {
    projects(includeSubgroups: true, hasVulnerabilities: true) {
      nodes {
        ...Project
      }
    }
    vulnerabilities(
      after: $after
      first: $first
      severity: $severity
      reportType: $reportType
      scanner: $scanner
      state: $state
      projectId: $projectId
    ) {
      nodes {
        ...Vulnerability
      }
      pageInfo {
        ...PageInfo
      }
    }
  }
}
