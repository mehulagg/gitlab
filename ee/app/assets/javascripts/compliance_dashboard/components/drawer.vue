<script>
import { GlDrawer } from '@gitlab/ui';
import Project from './drawer_sections/project.vue';

export default {
  components: {
    GlDrawer,
    Project,
  },
  props: {
    mergeRequest: {
      type: Object,
      required: true,
    },
    showDrawer: {
      type: Boolean,
      required: false,
      default: false,
    },
  },
  computed: {
    complianceFramework() {
      return this.mergeRequest.compliance_management_framework || null;
    },
  },
  methods: {
    getDrawerHeaderHeight() {
      const wrapperEl = document.querySelector('.content-wrapper');

      if (wrapperEl) {
        return `${wrapperEl.offsetTop}px`;
      }

      return '';
    },
  },
  // We set the drawer's z-index to 252 to clear flash messages that might be displayed in the page
  // and that have a z-index of 251.
  Z_INDEX: 252,
};
</script>
<template>
  <gl-drawer
    :open="showDrawer"
    :header-height="getDrawerHeaderHeight()"
    :z-index="$options.Z_INDEX"
    @close="$emit('close')"
  >
    <template #header>
      <h4 data-testid="dashboard-drawer-title">{{ mergeRequest.title }}</h4>
    </template>
    <template v-if="showDrawer" #default>
      <project
        :avatar-url="mergeRequest.project.avatar_url"
        :compliance-framework="complianceFramework"
        :name="mergeRequest.project.name"
        :url="mergeRequest.project.web_url"
      />
    </template>
  </gl-drawer>
</template>
