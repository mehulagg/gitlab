# frozen_string_literal: true

module Gitlab
  module DataBuilder
    module Vulnerability
      extend self

      def build(vulnerability)
        {
          object_kind: 'vulnerability',
          object_attributes: hook_attrs(vulnerability)
        }
      end

      def hook_attrs(vulnerability)
        {
          url: ::Gitlab::Routing.url_helpers.project_security_vulnerability_path(vulnerability.project, vulnerability),
          title: vulnerability.title,
          state: vulnerability.state,
          severity: vulnerability.severity,
          severity_overridden: vulnerability.severity_overridden,
          identifiers: vulnerability.identifiers,
          scanner: vulnerability.scanner,
          report_type: vulnerability.report_type,
          confidence: vulnerability.confidence,
          confidence_overridden: vulnerability.confidence_overridden,
          dismissed_at: vulnerability.dismissed_at,
          dismissed_by_id: vulnerability.dismissed_by_id
        }
      end
    end
  end
end
