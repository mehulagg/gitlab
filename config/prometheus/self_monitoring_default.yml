dashboard: 'Default dashboard'
priority: 1
panel_groups:
- group: Web Traffic - Error Ratio 
  panels:
    - title: Web Traffic - Error Ratio
      type: line-chart
      y_label: "Unhandled Exceptions (%)"
      metrics:
        - id: wter_web_service
          query_range: 'max(max_over_time(gitlab_service_errors:ratio{environment="%{ci_environment_slug}", type="web", stage="main"}[1m])) by (type)'
          unit: "%"
          label: "Web Service"
        - id: wter_degradation_slo
          query_range: 'avg(slo:max:gitlab_service_errors:ratio{environment="%{ci_environment_slug}", type="web", stage="main"}) or avg(slo:max:gitlab_service_errors:ratio{type="web"})'
          unit: "%"
          label: "Degradation SLO"
        - id: wter_outage_slo
          query_range: '2 * (avg(slo:max:gitlab_service_errors:ratio{environment="%{ci_environment_slug}", type="web", stage="main"}) or avg(slo:max:gitlab_service_errors:ratio{type="web"}))'
          unit: "%"
          label: "Outage SLO"
        - id: wter_last_week
          query_range: 'max(max_over_time(gitlab_service_errors:ratio{environment="%{ci_environment_slug}", type="web", stage="main"}[1m] offset 1w)) by (type)'
          unit: "%"
          label: "Last Week"
- group: API Traffic - Error Ratio
  panels:
    - title: API Traffic - Error Ratio
      type: line-chart
      y_label: "Unhandled Exceptions (%)"
      metrics:
        - id: ater_web_service
          query_range: 'max(max_over_time(gitlab_service_errors:ratio{environment="%{ci_environment_slug}", type="api", stage="main"}[1m])) by (type)'
          unit: "%"
          label: "Web Service"
        - id: ater_degradation_slo
          query_range: 'avg(slo:max:gitlab_service_errors:ratio{environment="%{ci_environment_slug}", type="api", stage="main"}) or avg(slo:max:gitlab_service_errors:ratio{type="web"})'
          unit: "%"
          label: "Degradation SLO"
        - id: ater_outage_slo
          query_range: '2 * (avg(slo:max:gitlab_service_errors:ratio{environment="%{ci_environment_slug}", type="api", stage="main"}) or avg(slo:max:gitlab_service_errors:ratio{type="web"}))'
          unit: "%"
          label: "Outage SLO"
        - id: ater_last_week
          query_range: 'max(max_over_time(gitlab_service_errors:ratio{environment="%{ci_environment_slug}", type="api", stage="main"}[1m] offset 1w)) by (type)'
          unit: "%"
          label: "Last Week"
