- blame = local_assigns.fetch(:blame, false)
- is_readable_text = blob.readable_text?

-# using FF here may not be the best adea as this partial is sahred between multiple pages (i.e. Blame page)
- if Feature.enabled?(:refactor_blob_viewer, @project, default_enabled: :yaml)
  #js-blob-nav-block.nav-block{ data: { 
  find_file_path: project_find_file_path(@project, @ref), 
  blame_path: project_blame_path(@project, @id), 
  is_readable_text: is_readable_text,
  commits_path: project_commits_path(@project, @id),
  permalink_path: project_blob_path(@project, tree_join(@commit.sha, @path))
  }}
- else
  .nav-block
    .tree-ref-container
      .tree-ref-holder
        = render 'shared/ref_switcher', destination: 'blob', path: @path
      %ul.breadcrumb.repo-breadcrumb
        %li.breadcrumb-item
          = link_to project_tree_path(@project, @ref) do
            = @project.path
        - path_breadcrumbs do |title, path|
          - title = truncate(title, length: 40)
          %li.breadcrumb-item
            - if path == @path
              = link_to project_blob_path(@project, tree_join(@ref, path)) do
                %strong= title
            - else
              = link_to title, project_tree_path(@project, tree_join(@ref, path))

    .tree-controls.gl-children-ml-sm-3<
      = render 'projects/find_file_link'
      -# only show normal/blame view links for text files
      - if blob.readable_text?
        - if blame
          = link_to 'Normal view', project_blob_path(@project, @id),
              class: 'gl-button btn btn-default'
        - else
          = link_to 'Blame', project_blame_path(@project, @id),
              class: 'gl-button btn btn-default js-blob-blame-link' unless blob.empty?

      = link_to 'History', project_commits_path(@project, @id),
          class: 'gl-button btn btn-default'

      = link_to 'Permalink', project_blob_path(@project,
          tree_join(@commit.sha, @path)), class: 'gl-button btn btn-default js-data-file-blob-permalink-url'
